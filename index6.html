<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>所得税青色申告決算書 全4ページ完全再現版</title>
    <style>
      :root {
        --line-green: #2e7d32;
        --bg-pale: #f9fff9;
        --input-yellow: #fffde7;
      }
      body {
        background: #444;
        font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", "Hiragino Sans", sans-serif;
        display: flex;
        flex-direction: column;
        /*もともとはcenter*/
        align-items: left;
        padding: 20px;
      }
      .page-container {
        background: white;
        width: 1000px;
        padding: 50px;
        margin-bottom: 40px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        position: relative;
        border: 1px solid #ccc;
      }
      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
      }
      .form-title {
        font-size: 24px;
        font-weight: bold;
        color: var(--line-green);
        text-align: center;
        flex-grow: 1;
        border-bottom: 2px solid var(--line-green);
        padding-bottom: 10px;
      }
      .page-tag {
        border: 1px solid var(--line-green);
        padding: 5px 10px;
        color: var(--line-green);
        font-weight: bold;
        writing-mode: vertical-rl;
        position: absolute;
        left: 10px;
        top: 100px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        table-layout: fixed;
        border: 2px solid var(--line-green);
      }
      th,
      td {
        border: 1px solid var(--line-green);
        padding: 4px;
        font-size: 11px;
        height: 24px;
      }
      th {
        background: var(--bg-pale);
        text-align: center;
      }
      .col-num {
        width: 25px;
        text-align: center;
        background: var(--bg-pale);
        font-size: 9px;
      }

      input {
        width: 100%;
        border: none;
        text-align: right;
        font-size: 14px;
        outline: none;
        background: transparent;
        font-family: "Courier New", Courier, monospace;
      }
      input:focus {
        background: var(--input-yellow);
      }
      .readonly {
        background: #eee;
        pointer-events: none;
        font-weight: bold;
      }

      .section-title {
        background: var(--bg-pale);
        font-weight: bold;
        text-align: left;
        padding-left: 10px;
        border-bottom: 2px solid var(--line-green);
      }
      .footer-num {
        text-align: center;
        margin-top: 20px;
        font-weight: bold;
      }
      .nav-panel {
        position: fixed;
        right: 20px;
        top: 20px;
        background: rgba(255, 255, 255, 0.9);
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        z-index: 1000;
      }
      .nav-panel button {
        display: block;
        width: 100%;
        margin: 5px 0;
        padding: 5px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="nav-panel">
      <strong>ページ移動</strong>
      <button onclick="window.scrollTo(0, 0)">1. 損益計算書</button>
      <button onclick="document.getElementById('p2').scrollIntoView()">2. 月別内訳</button>
      <button onclick="document.getElementById('p3').scrollIntoView()">3. 減価償却</button>
      <button onclick="document.getElementById('p4').scrollIntoView()">4. 貸借対照表</button>
      <hr />
      <strong>状態</strong><br /><small id="status">全項目自動計算中</small>
    </div>

    <div class="page-container" id="p1">
      <div class="page-tag">提出用</div>
      <div class="page-header">
        <div style="width: 150px">令和<input type="text" value="0" style="width: 30px; text-align: center; border-bottom: 1px solid #000" />年分</div>
        <div class="form-title">所得税青色申告決算書（一般用）</div>
        <div style="width: 150px; text-align: right">FA3000</div>
      </div>

      <table id="pl-table">
        <tr>
          <th colspan="2">科 目</th>
          <th colspan="2">金 額 (円)</th>
          <th colspan="2">科 目</th>
          <th colspan="2">金 額 (円)</th>
          <th colspan="2">科 目</th>
          <th colspan="2">金 額 (円)</th>
        </tr>
        <tr>
          <td colspan="2">売上(収入)金額</td>
          <td class="col-num">①</td>
          <td><input type="text" id="f1" class="calc" onblur="fmt(this)" /></td>
          <td rowspan="13" style="writing-mode: vertical-rl">経費</td>
          <td>租税公課</td>
          <td class="col-num">⑧</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td rowspan="10" style="writing-mode: vertical-rl">各種引当金・準備金等</td>
          <td>貸倒引当金</td>
          <td class="col-num">㉞</td>
          <td><input type="text" class="calc" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td rowspan="5" style="writing-mode: vertical-rl">売上原価</td>
          <td>期首商品棚卸高</td>
          <td class="col-num">②</td>
          <td><input type="text" id="f2" class="calc" onblur="fmt(this)" /></td>
          <td>荷造運賃</td>
          <td class="col-num">⑨</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>(繰戻額等)</td>
          <td class="col-num">㉟</td>
          <td><input type="text" class="calc" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>仕入金額</td>
          <td class="col-num">③</td>
          <td><input type="text" id="f3" class="calc" onblur="fmt(this)" /></td>
          <td>水道光熱費</td>
          <td class="col-num">⑩</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td></td>
          <td class="col-num">㊱</td>
          <td><input type="text" class="calc" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>小計 (②+③)</td>
          <td class="col-num">④</td>
          <td><input type="text" id="f4" class="readonly" /></td>
          <td>旅費交通費</td>
          <td class="col-num">⑪</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>計</td>
          <td class="col-num">㊲</td>
          <td><input type="text" id="f37" class="readonly" /></td>
        </tr>
        <tr>
          <td>期末商品棚卸高</td>
          <td class="col-num">⑤</td>
          <td><input type="text" id="f5" class="calc" onblur="fmt(this)" /></td>
          <td>通信費</td>
          <td class="col-num">⑫</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>専従者給与</td>
          <td class="col-num">㊳</td>
          <td><input type="text" id="f38" class="calc" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>差引原価(④-⑤)</td>
          <td class="col-num">⑥</td>
          <td><input type="text" id="f6" class="readonly" /></td>
          <td>広告宣伝費</td>
          <td class="col-num">⑬</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>貸倒引当金</td>
          <td class="col-num">㊴</td>
          <td><input type="text" class="calc" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td colspan="2">差引金額 (①-⑥)</td>
          <td class="col-num">⑦</td>
          <td><input type="text" id="f7" class="readonly" /></td>
          <td>接待交際費</td>
          <td class="col-num">⑭</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>(繰入額等)</td>
          <td class="col-num">㊵</td>
          <td><input type="text" class="calc" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td colspan="4" rowspan="3" style="font-size: 9px; vertical-align: top; padding: 10px">※この青色申告決算書は機械で読み取りますので、黒のボールペンで書いてください。 [cite: 314]</td>
          <td>損害保険料</td>
          <td class="col-num">⑮</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td></td>
          <td class="col-num">㊶</td>
          <td><input type="text" class="calc" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <!-- <td rowspan="4" style="writing-mode: vertical-rl">費</td> -->
          <td>修繕費</td>
          <td class="col-num">⑯</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>計</td>
          <td class="col-num">㊷</td>
          <td><input type="text" id="f42" class="readonly" /></td>
        </tr>
        <tr>
          <td>消耗品費</td>
          <td class="col-num">⑰</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="2">特別控除前所得</td>
          <td class="col-num">㊸</td>
          <td><input type="text" id="f43" class="readonly" /></td>
        </tr>
        <tr>
          <td colspan="4"></td>
          <td>減価償却費</td>
          <td class="col-num">⑱</td>
          <td><input type="text" id="f18" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="2">青色申告特別控除額</td>
          <td class="col-num">㊹</td>
          <td><input type="text" id="f44" value="650,000" class="calc" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td colspan="2">雑費</td>
          <td class="col-num">㉛</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>福利厚生費</td>
          <td class="col-num">⑲</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="2" style="background: #c8e6c9; font-weight: bold">所 得 金 額</td>
          <td class="col-num">㊺</td>
          <td><input type="text" id="f45" class="readonly" style="background: #c8e6c9" /></td>
        </tr>
        <tr>
          <td colspan="2" style="background: var(--bg-pale)">計</td>
          <td class="col-num">㉜</td>
          <td><input type="text" id="f32" class="readonly" /></td>
          <td>給料賃金</td>
          <td class="col-num">⑳</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="4"></td>
        </tr>
      </table>
      <div class="footer-num">- 1 -</div>
    </div>

    <div class="page-container" id="p2">
      <div class="page-tag">提出用</div>
      <div class="section-title">○ 月別売上（収入）金額及び仕入金額 [cite: 413]</div>
      <table>
        <tr>
          <th>月</th>
          <th>売上(収入)金額</th>
          <th>仕入金額</th>
          <th>月</th>
          <th>売上(収入)金額</th>
          <th>仕入金額</th>
        </tr>
        <tr>
          <td>1月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
          <td>7月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
        </tr>
        <tr>
          <td>2月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
          <td>8月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
        </tr>
        <tr>
          <td>3月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
          <td>9月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
        </tr>
        <tr>
          <td>4月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
          <td>10月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
        </tr>
        <tr>
          <td>5月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
          <td>11月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
        </tr>
        <tr>
          <td>6月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
          <td>12月</td>
          <td><input type="text" class="m-s" oninput="sumM()" /></td>
          <td><input type="text" class="m-c" oninput="sumM()" /></td>
        </tr>
        <tr style="background: #eee">
          <td>計</td>
          <td><input type="text" id="ms_total" class="readonly" /></td>
          <td><input type="text" id="mc_total" class="readonly" /></td>
          <td colspan="3">※合計は1ページ目の①③へ自動転記</td>
        </tr>
      </table>
      <div class="footer-num">- 2 -</div>
    </div>

    <div class="page-container" id="p3">
      <div class="page-tag">提出用</div>
      <div class="section-title">○ 減価償却費の計算 [cite: 427]</div>
      <table>
        <tr>
          <th>資産名称</th>
          <th>取得価額</th>
          <th>償却の基礎</th>
          <th>耐用年数</th>
          <th>本年償却費</th>
          <th>未償却残高</th>
        </tr>
        <tr>
          <td><input type="text" placeholder="例：車両" /></td>
          <td><input type="text" onblur="fmt(this)" /></td>
          <td><input type="text" onblur="fmt(this)" /></td>
          <td><input type="text" style="text-align: center" /></td>
          <td><input type="text" class="d-val" oninput="sumD()" onblur="fmt(this)" /></td>
          <td><input type="text" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td><input type="text" /></td>
          <td><input type="text" onblur="fmt(this)" /></td>
          <td><input type="text" onblur="fmt(this)" /></td>
          <td><input type="text" /></td>
          <td><input type="text" class="d-val" oninput="sumD()" onblur="fmt(this)" /></td>
          <td><input type="text" onblur="fmt(this)" /></td>
        </tr>
        <tr style="background: #eee">
          <td>計</td>
          <td colspan="3"></td>
          <td><input type="text" id="d_total" class="readonly" /></td>
          <td></td>
        </tr>
      </table>
      <div class="footer-num">- 3 -</div>
    </div>

    <div class="page-container" id="p4">
      <div class="page-tag">提出用</div>
      <div class="page-header">
        <div class="form-title">貸 借 対 照 表 [cite: 442]</div>
      </div>
      <div style="display: flex; gap: 10px">
        <table style="width: 50%">
          <tr>
            <th colspan="2">資産の部</th>
            <th>期首</th>
            <th>期末</th>
          </tr>
          <tr>
            <td colspan="2">現金・当座預金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="ast-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">売掛金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="ast-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">棚卸資産</td>
            <td><input type="text" id="bs_inv_s" class="readonly" /></td>
            <td><input type="text" id="bs_inv_e" class="readonly" /></td>
          </tr>
          <tr style="background: #eee">
            <td colspan="2">資産合計</td>
            <td><input type="text" class="readonly" /></td>
            <td><input type="text" id="ast_total" class="readonly" /></td>
          </tr>
        </table>
        <table style="width: 50%">
          <tr>
            <th colspan="2">負債・資本の部</th>
            <th>期首</th>
            <th>期末</th>
          </tr>
          <tr>
            <td colspan="2">買掛金・借入金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="liab-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">元入金 [cite: 452]</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="liab-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">今期所得(43番)</td>
            <td><input type="text" class="readonly" /></td>
            <td><input type="text" id="bs_income" class="readonly" /></td>
          </tr>
          <tr style="background: #eee">
            <td colspan="2">負債資本合計</td>
            <td><input type="text" class="readonly" /></td>
            <td><input type="text" id="liab_total" class="readonly" /></td>
          </tr>
        </table>
      </div>
      <div class="section-title" style="margin-top: 20px">○ 製造原価の計算（該当者のみ） [cite: 448]</div>
      <table>
        <tr>
          <td>期首材料</td>
          <td><input type="text" onblur="fmt(this)" /></td>
          <td>労務費</td>
          <td><input type="text" onblur="fmt(this)" /></td>
          <td>外注工賃</td>
          <td><input type="text" onblur="fmt(this)" /></td>
        </tr>
      </table>
      <div class="footer-num">- 4 -</div>
    </div>

    <script>
      const nf = new Intl.NumberFormat("ja-JP");
      function fmt(el) {
        el.value = el.value ? nf.format(val(el.value)) : "";
        calc();
      }
      function val(str) {
        return parseFloat(String(str).replace(/,/g, "")) || 0;
      }
      function set(id, v) {
        document.getElementById(id).value = nf.format(v);
      }

      function sumM() {
        let s = 0,
          c = 0;
        document.querySelectorAll(".m-s").forEach((e) => (s += val(e.value)));
        document.querySelectorAll(".m-c").forEach((e) => (c += val(e.value)));
        set("ms_total", s);
        set("mc_total", c);
        document.getElementById("f1").value = nf.format(s);
        document.getElementById("f3").value = nf.format(c);
        calc();
      }

      function sumD() {
        let t = 0;
        document.querySelectorAll(".d-val").forEach((e) => (t += val(e.value)));
        set("d_total", t);
        document.getElementById("f18").value = nf.format(t);
        calc();
      }

      function sumBS() {
        let a = 0,
          l = 0;
        document.querySelectorAll(".ast-e").forEach((e) => (a += val(e.value)));
        document.querySelectorAll(".liab-e").forEach((e) => (l += val(e.value)));
        a += val(document.getElementById("bs_inv_e").value);
        l += val(document.getElementById("bs_income").value);
        set("ast_total", a);
        set("liab_total", l);
      }

      function calc() {
        const f1 = val(document.getElementById("f1").value);
        const f2 = val(document.getElementById("f2").value);
        const f3 = val(document.getElementById("f3").value);
        const f4 = f2 + f3;
        set("f4", f4);
        const f5 = val(document.getElementById("f5").value);
        const f6 = f4 - f5;
        set("f6", f6);
        const f7 = f1 - f6;
        set("f7", f7);

        let expSum = 0;
        document.querySelectorAll(".exp").forEach((e) => (expSum += val(e.value)));
        set("f32", expSum);

        const f33 = f7 - expSum;
        const f42 = val(document.getElementById("f37").value) + val(document.getElementById("f38").value); // 簡略化
        set("f43", f33);

        const f44 = val(document.getElementById("f44").value);
        const ded = Math.min(Math.max(0, f33), f44);
        set("f45", f33 - ded);

        // BS連動
        document.getElementById("bs_inv_s").value = nf.format(f2);
        document.getElementById("bs_inv_e").value = nf.format(f5);
        document.getElementById("bs_income").value = nf.format(f33);
        sumBS();
      }
    </script>
  </body>
</html>
