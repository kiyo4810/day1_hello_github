<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>所得税青色申告決算書 究極の家計簿版</title>
    <style>
      :root {
        --line-green: #2e7d32;
        --bg-pale: #f9fff9;
        --input-yellow: #fffde7;
      }
      body {
        background: #444;
        font-family: "Hiragino Kaku Gothic ProN", sans-serif;
        display: flex;
        flex-direction: column;
        align-items: left;
        padding: 20px;
      }
      .page-container {
        background: white;
        width: 1000px;
        padding: 40px;
        margin-bottom: 40px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        position: relative;
      }
      .form-title {
        font-size: 24px;
        font-weight: bold;
        color: var(--line-green);
        text-align: center;
        border-bottom: 3px double var(--line-green);
        margin: 10px 0;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
        border: 2px solid var(--line-green);
        margin-bottom: 10px;
      }
      th,
      td {
        border: 1px solid var(--line-green);
        height: 26px;
        font-size: 11px;
        padding: 0 4px;
        overflow: hidden;
      }
      th {
        background: var(--bg-pale);
        font-weight: normal;
        text-align: center;
      }
      .col-num {
        width: 30px;
        text-align: center;
        background: var(--bg-pale);
        font-size: 9px;
      }
      input {
        width: 100%;
        height: 100%;
        border: none;
        text-align: right;
        font-size: 14px;
        background: transparent;
        font-family: "Courier New", monospace;
        outline: none;
      }
      input.text-left {
        text-align: left;
        font-size: 11px;
      }
      .readonly {
        background: #eee;
        font-weight: bold;
        pointer-events: none;
      }
      .footer-num {
        text-align: center;
        font-weight: bold;
        margin-top: 10px;
      }
      .nav-panel {
        position: fixed;
        right: 20px;
        top: 20px;
        background: white;
        padding: 10px;
        border: 2px solid var(--line-green);
        z-index: 1000;
      }
      button {
        display: block;
        width: 100%;
        margin: 2px 0;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="nav-panel">
      <strong>ページ移動</strong>
      <button onclick="window.scrollTo(0, 0)">1. 損益計算書</button>
      <button onclick="document.getElementById('p2').scrollIntoView()">2. 月別内訳</button>
      <button onclick="document.getElementById('p3').scrollIntoView()">3. 減価償却</button>
      <button onclick="document.getElementById('p4').scrollIntoView()">4. 貸借対照表</button>
    </div>

    <div class="page-container" id="p1">
      <div class="form-title">所得税青色申告決算書（一般用）</div>
      <table>
        <colgroup>
          <col width="12%" />
          <col width="3%" />
          <col width="18%" />
          <col width="2%" />
          <col width="12%" />
          <col width="3%" />
          <col width="18%" />
          <col width="2%" />
          <col width="12%" />
          <col width="3%" />
          <col width="18%" />
        </colgroup>
        <tr>
          <th colspan="3">売上原価</th>
          <th></th>
          <th colspan="3">経 費</th>
          <th></th>
          <th colspan="3">所得金額</th>
        </tr>
        <tr>
          <td>売上金額</td>
          <td class="col-num">①</td>
          <td><input type="text" id="f1" onblur="fmt(this)" /></td>
          <td rowspan="15" style="writing-mode: vertical-rl; background: var(--bg-pale)">経費</td>
          <td>租税公課</td>
          <td class="col-num">⑧</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td rowspan="14" style="writing-mode: vertical-rl; background: var(--bg-pale)">引当金</td>
          <td>繰戻貸倒</td>
          <td class="col-num">㉞</td>
          <td><input type="text" class="calc res-rev" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>期首棚卸</td>
          <td class="col-num">②</td>
          <td><input type="text" id="f2" onblur="fmt(this)" /></td>
          <td>荷造運賃</td>
          <td class="col-num">⑨</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>(繰戻額)</td>
          <td class="col-num">㉟</td>
          <td><input type="text" class="calc res-rev" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>仕入金額</td>
          <td class="col-num">③</td>
          <td><input type="text" id="f3" onblur="fmt(this)" /></td>
          <td>水道光熱</td>
          <td class="col-num">⑩</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>計(㉞-㊱)</td>
          <td class="col-num">㊲</td>
          <td><input type="text" id="f37" class="readonly" /></td>
        </tr>
        <tr>
          <td>小計(②+③)</td>
          <td class="col-num">④</td>
          <td><input type="text" id="f4" class="readonly" /></td>
          <td>通信費</td>
          <td class="col-num">⑫</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>専従者給</td>
          <td class="col-num">㊳</td>
          <td><input type="text" id="f38" class="calc res-exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>期末棚卸</td>
          <td class="col-num">⑤</td>
          <td><input type="text" id="f5" onblur="fmt(this)" /></td>
          <td>広告宣伝</td>
          <td class="col-num">⑬</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>繰入貸倒</td>
          <td class="col-num">㊴</td>
          <td><input type="text" class="calc res-exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>差引原価</td>
          <td class="col-num">⑥</td>
          <td><input type="text" id="f6" class="readonly" /></td>
          <td>接待交際</td>
          <td class="col-num">⑭</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>計(㊳-㊶)</td>
          <td class="col-num">㊷</td>
          <td><input type="text" id="f42" class="readonly" /></td>
        </tr>
        <tr>
          <td>差引金額</td>
          <td class="col-num">⑦</td>
          <td><input type="text" id="f7" class="readonly" /></td>
          <td>修繕費</td>
          <td class="col-num">⑯</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="1">控除前所得</td>
          <td class="col-num">㊸</td>
          <td><input type="text" id="f43" class="readonly" /></td>
        </tr>
        <tr>
          <td colspan="3" rowspan="3" style="font-size: 10px">※究極の家計簿として活用ください</td>
          <td>消耗品費</td>
          <td class="col-num">⑰</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="1">特別控除</td>
          <td class="col-num">㊹</td>
          <td><input type="text" id="f44" value="650,000" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>減価償却</td>
          <td class="col-num">⑱</td>
          <td><input type="text" id="f18" class="readonly" /></td>
          <td colspan="1" style="font-weight: bold">所得金額</td>
          <td class="col-num">㊺</td>
          <td><input type="text" id="f45" class="readonly" style="background: #c8e6c9" /></td>
        </tr>
        <tr>
          <td>福利厚生</td>
          <td class="col-num">⑲</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="3"></td>
        </tr>
        <tr>
          <td>給料賃金</td>
          <td class="col-num">⑳</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>地代家賃</td>
          <td class="col-num">㉓</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉕" /></td>
          <td class="col-num">㉕</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>外注工賃</td>
          <td class="col-num">㉑</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>貸倒金</td>
          <td class="col-num">㉔</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉖" /></td>
          <td class="col-num">㉖</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>利子割引</td>
          <td class="col-num">㉒</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉗" /></td>
          <td class="col-num">㉗</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉘" /></td>
          <td class="col-num">㉘</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td><input type="text" class="text-left" placeholder="科目㉙" /></td>
          <td class="col-num">㉙</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉚" /></td>
          <td class="col-num">㉚</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>雑費</td>
          <td class="col-num">㉛</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
        </tr>
        <tr style="background: var(--bg-pale)">
          <td>経費計</td>
          <td class="col-num">㉜</td>
          <td><input type="text" id="f32" class="readonly" /></td>
          <td colspan="2">差引(⑦-㉜)</td>
          <td class="col-num">㉝</td>
          <td><input type="text" id="f33" class="readonly" /></td>
          <td colspan="3"></td>
        </tr>
      </table>
      <div class="footer-num">- 1 -</div>
    </div>

<div class="page-container" id="p2">
  <div style="display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 20px;">
    <div style="font-size: 18px">令和 <input type="text" style="width: 40px; border-bottom: 1px solid #000; text-align: center" /> 年分</div>
    <div class="form-title" style="width: 50%; border-bottom: none">所得税青色申告決算書（一般用）</div>
    <div style="text-align: right; font-size: 12px">[提出用] FA3025<br>2ページ目</div>
  </div>

  <div style="margin-bottom: 30px">
    <div style="font-size: 14px; font-weight: bold; margin-bottom: 5px; border-left: 4px solid var(--line-green); padding-left: 8px;">○月別売上（収入）金額及び仕入金額</div>
    <table style="width: 100%">
      <colgroup>
        <col width="10%" />
        <col width="45%" />
        <col width="45%" />
      </colgroup>
      <tr>
        <th>月</th>
        <th>売上（収入）金額（円）</th>
        <th>仕 入 金 額（円）</th>
      </tr>
      <tbody id="month-grid-full">
        </tbody>
      <tr>
        <td align="center">家事消費等</td>
        <td><input type="text" class="m-s" oninput="sumM()" onblur="fmt(this)" /></td>
        <td style="background: #eee"></td>
      </tr>
      <tr>
        <td align="center">雑収入</td>
        <td><input type="text" class="m-s" oninput="sumM()" onblur="fmt(this)" /></td>
        <td style="background: #eee"></td>
      </tr>
      <tr style="background: var(--bg-pale); font-weight: bold">
        <td align="center">計</td>
        <td><input type="text" id="ms_total" class="readonly" /></td>
        <td><input type="text" id="mc_total" class="readonly" /></td>
      </tr>
    </table>
  </div>

  <div style="display: flex; gap: 20px">
    <div style="flex: 1">
      <div style="font-size: 13px; font-weight: bold; margin-bottom: 5px; border-left: 4px solid var(--line-green); padding-left: 8px;">○給料賃金の内訳</div>
      <table>
        <tr>
          <th>氏名</th>
          <th>年齢</th>
          <th>従事月</th>
          <th>支給額（円）</th>
        </tr>
        <tr><td><input type="text" class="text-left" /></td><td><input type="text" /></td><td><input type="text" /></td><td><input type="text" class="sal-val" oninput="sumSal()" onblur="fmt(this)" /></td></tr>
        <tr><td><input type="text" class="text-left" /></td><td><input type="text" /></td><td><input type="text" /></td><td><input type="text" class="sal-val" oninput="sumSal()" onblur="fmt(this)" /></td></tr>
        <tr><td><input type="text" class="text-left" /></td><td><input type="text" /></td><td><input type="text" /></td><td><input type="text" class="sal-val" oninput="sumSal()" onblur="fmt(this)" /></td></tr>
        <tr style="background: #eee">
          <td colspan="3" align="center">計</td>
          <td><input type="text" id="sal_total" class="readonly" /></td>
        </tr>
      </table>
    </div>

    <div style="flex: 1">
      <div style="font-size: 13px; font-weight: bold; margin-bottom: 5px; border-left: 4px solid var(--line-green); padding-left: 8px;">○専従者給与の内訳</div>
      <table>
        <tr>
          <th>氏名</th>
          <th>続柄</th>
          <th>年齢</th>
          <th>支給額（円）</th>
        </tr>
        <tr><td><input type="text" class="text-left" /></td><td><input type="text" /></td><td><input type="text" /></td><td><input type="text" class="family-sal" oninput="sumFam()" onblur="fmt(this)" /></td></tr>
        <tr><td><input type="text" class="text-left" /></td><td><input type="text" /></td><td><input type="text" /></td><td><input type="text" class="family-sal" oninput="sumFam()" onblur="fmt(this)" /></td></tr>
        <tr style="background: #eee">
          <td colspan="3" align="center">計</td>
          <td><input type="text" id="fam_total" class="readonly" /></td>
        </tr>
      </table>
    </div>
  </div>

  <div style="display: flex; gap: 20px; margin-top: 30px">
    <div style="flex: 1">
      <div style="font-size: 13px; font-weight: bold; margin-bottom: 5px; border-left: 4px solid var(--line-green); padding-left: 8px;">○貸倒引当金繰入額の計算</div>
      <table>
        <tr>
          <td style="width: 70%">個別評価による繰入額</td>
          <td class="col-num">①</td>
          <td><input type="text" id="bad_debt_1" oninput="calcBadDebt()" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>一括評価対象の債権合計</td>
          <td class="col-num">②</td>
          <td><input type="text" id="bad_debt_base" oninput="calcBadDebt()" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>繰入限度額 (②×5.5/1000)</td>
          <td class="col-num">③</td>
          <td><input type="text" id="bad_debt_limit" class="readonly" /></td>
        </tr>
        <tr style="background: var(--bg-pale); font-weight: bold">
          <td>本年分繰入額 (①+③)</td>
          <td class="col-num">⑤</td>
          <td><input type="text" id="bad_debt_total" class="readonly" /></td>
        </tr>
      </table>
    </div>

    <div style="flex: 1">
      <div style="font-size: 13px; font-weight: bold; margin-bottom: 5px; border-left: 4px solid var(--line-green); padding-left: 8px;">○青色申告特別控除額の計算</div>
      <table>
        <tr>
          <td style="width: 70%">控除前所得金額 (1ページ㊸)</td>
          <td class="col-num">⑦</td>
          <td><input type="text" id="p2_income_pre" class="readonly" /></td>
        </tr>
        <tr>
          <td>控除限度額(65万円等)との比較</td>
          <td class="col-num">⑧</td>
          <td><input type="text" id="p2_deduction" class="readonly" /></td>
        </tr>
        <tr style="background: #c8e6c9; font-weight: bold">
          <td>青色申告特別控除額</td>
          <td class="col-num">⑨</td>
          <td><input type="text" id="p2_deduction_final" class="readonly" /></td>
        </tr>
      </table>
    </div>
  </div>

  <div class="footer-num" style="margin-top: 50px">- 2 -</div>
</div>
    <div class="page-container" id="p3">
      <div class="form-title">減価償却費の計算</div>
      <table>
        <tr>
          <th>資産名称</th>
          <th>取得価額</th>
          <th>耐用年数</th>
          <th>本年償却費</th>
          <th>未償却残高</th>
        </tr>
        <tbody id="dep-rows"></tbody>
        <tr style="background: #eee">
          <td>計</td>
          <td colspan="2"></td>
          <td><input type="text" id="d_total" class="readonly" /></td>
          <td></td>
        </tr>
      </table>
      <div class="footer-num">- 3 -</div>
    </div>

    <div class="page-container" id="p4">
      <div class="form-title">貸 借 対 照 表</div>
      <div style="display: flex; gap: 10px">
        <table style="width: 50%">
          <tr>
            <th colspan="2">資産の部</th>
            <th>期首</th>
            <th>期末</th>
          </tr>
          <tr>
            <td colspan="2">現金・預金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="ast-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">売掛金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="ast-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">棚卸資産</td>
            <td><input type="text" id="bs_inv_s" class="readonly" /></td>
            <td><input type="text" id="bs_inv_e" class="readonly" /></td>
          </tr>
          <tr style="background: #eee">
            <td>資産計</td>
            <td colspan="2"></td>
            <td><input type="text" id="ast_total" class="readonly" /></td>
          </tr>
        </table>
        <table style="width: 50%">
          <tr>
            <th colspan="2">負債・資本の部</th>
            <th>期首</th>
            <th>期末</th>
          </tr>
          <tr>
            <td colspan="2">買掛金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="liab-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">元入金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="liab-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">所得(㊸番)</td>
            <td><input type="text" class="readonly" /></td>
            <td><input type="text" id="bs_income" class="readonly" /></td>
          </tr>
          <tr style="background: #eee">
            <td>負債計</td>
            <td colspan="2"></td>
            <td><input type="text" id="liab_total" class="readonly" /></td>
          </tr>
        </table>
      </div>
      <div class="footer-num">- 4 -</div>
    </div>

<script>
  const nf = new Intl.NumberFormat("ja-JP");
  const val = (s) => parseFloat(String(s).replace(/,/g, "")) || 0;
  const set = (id, v) => {
    const el = document.getElementById(id);
    if (el) el.value = nf.format(v);
  };

  // --- 初期化：2ページ目の12ヶ月行を自動生成 ---
  window.onload = () => {
    const mGridFull = document.getElementById('month-grid-full');
    if (mGridFull) {
      mGridFull.innerHTML = ""; // 重複防止
      for (let i = 1; i <= 12; i++) {
        mGridFull.innerHTML += `
          <tr>
            <td align="center">${i}月</td>
            <td><input type="text" class="m-s" oninput="sumM()" onblur="fmt(this)" /></td>
            <td><input type="text" class="m-c" oninput="sumM()" onblur="fmt(this)" /></td>
          </tr>`;
      }
    }
    // 減価償却行生成
    const dRows = document.getElementById("dep-rows");
    if (dRows) {
        dRows.innerHTML = "";
        for (let i = 0; i < 5; i++) {
            dRows.innerHTML += `<tr><td><input type="text" class="text-left"></td><td><input type="text" onblur="fmt(this)"></td><td><input type="text"></td><td><input type="text" class="d-val" oninput="sumD()" onblur="fmt(this)"></td><td><input type="text" onblur="fmt(this)"></td></tr>`;
        }
    }
  };

  function fmt(el) {
    el.value = el.value ? nf.format(val(el.value)) : "";
    calc();
  }

  // 2ページ目：月別合計を1ページ目の①売上・③仕入へ
  function sumM() {
    let s = 0, c = 0;
    document.querySelectorAll(".m-s").forEach((e) => (s += val(e.value)));
    document.querySelectorAll(".m-c").forEach((e) => (c += val(e.value)));
    set("ms_total", s);
    set("mc_total", c);
    set("f1", s); // 1P売上
    set("f3", c); // 1P仕入
    calc();
  }

  // 3ページ目：減価償却費を1ページ目の⑱へ
  function sumD() {
    let t = 0;
    document.querySelectorAll(".d-val").forEach((e) => (t += val(e.value)));
    set("d_total", t);
    set("f18", t); // 1P減価償却費
    calc();
  }

  // 2ページ目：給料賃金合計を1ページ目の⑳へ
  function sumSal() {
    let t = 0;
    document.querySelectorAll(".sal-val").forEach(e => t += val(e.value));
    set("sal_total", t);
    // 1Pの経費リストの中から「給料賃金」を探してセット
    // ※ 20番(⑳)のinputにid="f20"を付けておくと確実ですが、なければ以下で対応
    const f20 = document.getElementById("f20");
    if(f20) f20.value = nf.format(t); 
    calc();
  }

  // 2ページ目：専従者給与を1ページ目の㊳へ
  function sumFam() {
    let t = 0;
    document.querySelectorAll(".family-sal").forEach(e => t += val(e.value));
    set("fam_total", t);
    set("f38", t); 
    calc();
  }

  // 2ページ目：貸倒引当金の計算を1ページ目の㊴へ
  function calcBadDebt() {
    const individual = val(document.getElementById("bad_debt_1").value);
    const base = val(document.getElementById("bad_debt_base").value);
    const limit = Math.floor(base * 0.0055);
    set("bad_debt_limit", limit);
    const total = individual + limit;
    set("bad_debt_total", total);
    set("f39", total); // 1P繰入
    calc();
  }

  function sumBS() {
    let a = 0, l = 0;
    document.querySelectorAll(".ast-e").forEach((e) => (a += val(e.value)));
    document.querySelectorAll(".liab-e").forEach((e) => (l += val(e.value)));
    a += val(document.getElementById("bs_inv_e").value);
    l += val(document
  </body>
</html>
