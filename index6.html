<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>所得税青色申告決算書 究極の家計簿版</title>
    <style>
      :root {
        --line-green: #2e7d32;
        --bg-pale: #f9fff9;
        --input-yellow: #fffde7;
      }
      body {
        background: #444;
        font-family: "Hiragino Kaku Gothic ProN", sans-serif;
        display: flex;
        flex-direction: column;
        align-items: left;
        padding: 20px;
      }
      .page-container {
        background: white;
        width: 1000px;
        padding: 40px;
        margin-bottom: 40px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        position: relative;
      }
      .form-title {
        font-size: 24px;
        font-weight: bold;
        color: var(--line-green);
        text-align: center;
        border-bottom: 3px double var(--line-green);
        margin: 10px 0;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
        border: 2px solid var(--line-green);
        margin-bottom: 10px;
      }
      th,
      td {
        border: 1px solid var(--line-green);
        height: 26px;
        font-size: 11px;
        padding: 0 4px;
        overflow: hidden;
      }
      th {
        background: var(--bg-pale);
        font-weight: normal;
        text-align: center;
      }
      .col-num {
        width: 30px;
        text-align: center;
        background: var(--bg-pale);
        font-size: 9px;
      }
      input {
        width: 100%;
        height: 100%;
        border: none;
        text-align: right;
        font-size: 14px;
        background: transparent;
        font-family: "Courier New", monospace;
        outline: none;
      }
      input.text-left {
        text-align: left;
        font-size: 11px;
      }
      .readonly {
        background: #eee;
        font-weight: bold;
        pointer-events: none;
      }
      .footer-num {
        text-align: center;
        font-weight: bold;
        margin-top: 10px;
      }
      .nav-panel {
        position: fixed;
        right: 20px;
        top: 20px;
        background: white;
        padding: 10px;
        border: 2px solid var(--line-green);
        z-index: 1000;
      }
      button {
        display: block;
        width: 100%;
        margin: 2px 0;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="nav-panel">
      <strong>ページ移動</strong>
      <button onclick="window.scrollTo(0, 0)">1. 損益計算書</button>
      <button onclick="document.getElementById('p2').scrollIntoView()">2. 月別内訳</button>
      <button onclick="document.getElementById('p3').scrollIntoView()">3. 減価償却</button>
      <button onclick="document.getElementById('p4').scrollIntoView()">4. 貸借対照表</button>
    </div>

    <div class="page-container" id="p1">
      <div class="form-title">所得税青色申告決算書（一般用）</div>
      <table>
        <colgroup>
          <col width="12%" />
          <col width="3%" />
          <col width="18%" />
          <col width="2%" />
          <col width="12%" />
          <col width="3%" />
          <col width="18%" />
          <col width="2%" />
          <col width="12%" />
          <col width="3%" />
          <col width="18%" />
        </colgroup>
        <tr>
          <th colspan="3">売上原価</th>
          <th></th>
          <th colspan="3">経 費</th>
          <th></th>
          <th colspan="3">所得金額</th>
        </tr>
        <tr>
          <td>売上金額</td>
          <td class="col-num">①</td>
          <td><input type="text" id="f1" onblur="fmt(this)" /></td>
          <td rowspan="15" style="writing-mode: vertical-rl; background: var(--bg-pale)">経費</td>
          <td>租税公課</td>
          <td class="col-num">⑧</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td rowspan="10" style="writing-mode: vertical-rl; background: var(--bg-pale)">引当金</td>
          <td>繰戻貸倒</td>
          <td class="col-num">㉞</td>
          <td><input type="text" class="calc res-rev" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>期首棚卸</td>
          <td class="col-num">②</td>
          <td><input type="text" id="f2" onblur="fmt(this)" /></td>
          <td>荷造運賃</td>
          <td class="col-num">⑨</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>(繰戻額)</td>
          <td class="col-num">㉟</td>
          <td><input type="text" class="calc res-rev" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>仕入金額</td>
          <td class="col-num">③</td>
          <td><input type="text" id="f3" onblur="fmt(this)" /></td>
          <td>水道光熱</td>
          <td class="col-num">⑩</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>計(㉞-㊱)</td>
          <td class="col-num">㊲</td>
          <td><input type="text" id="f37" class="readonly" /></td>
        </tr>
        <tr>
          <td>小計(②+③)</td>
          <td class="col-num">④</td>
          <td><input type="text" id="f4" class="readonly" /></td>
          <td>通信費</td>
          <td class="col-num">⑫</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>専従者給</td>
          <td class="col-num">㊳</td>
          <td><input type="text" id="f38" class="calc res-exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>期末棚卸</td>
          <td class="col-num">⑤</td>
          <td><input type="text" id="f5" onblur="fmt(this)" /></td>
          <td>広告宣伝</td>
          <td class="col-num">⑬</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>繰入貸倒</td>
          <td class="col-num">㊴</td>
          <td><input type="text" class="calc res-exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>差引原価</td>
          <td class="col-num">⑥</td>
          <td><input type="text" id="f6" class="readonly" /></td>
          <td>接待交際</td>
          <td class="col-num">⑭</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>計(㊳-㊶)</td>
          <td class="col-num">㊷</td>
          <td><input type="text" id="f42" class="readonly" /></td>
        </tr>
        <tr>
          <td>差引金額</td>
          <td class="col-num">⑦</td>
          <td><input type="text" id="f7" class="readonly" /></td>
          <td>修繕費</td>
          <td class="col-num">⑯</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="2">控除前所得</td>
          <td class="col-num">㊸</td>
          <td><input type="text" id="f43" class="readonly" /></td>
        </tr>
        <tr>
          <td colspan="3" rowspan="3" style="font-size: 10px">※究極の家計簿として活用ください</td>
          <td>消耗品費</td>
          <td class="col-num">⑰</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="2">特別控除</td>
          <td class="col-num">㊹</td>
          <td><input type="text" id="f44" value="650,000" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>減価償却</td>
          <td class="col-num">⑱</td>
          <td><input type="text" id="f18" class="readonly" /></td>
          <td colspan="2" style="font-weight: bold">所得金額</td>
          <td class="col-num">㊺</td>
          <td><input type="text" id="f45" class="readonly" style="background: #c8e6c9" /></td>
        </tr>
        <tr>
          <td>福利厚生</td>
          <td class="col-num">⑲</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td colspan="3"></td>
        </tr>
        <tr>
          <td>給料賃金</td>
          <td class="col-num">⑳</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>地代家賃</td>
          <td class="col-num">㉓</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉕" /></td>
          <td class="col-num">㉕</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>外注工賃</td>
          <td class="col-num">㉑</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>貸倒金</td>
          <td class="col-num">㉔</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉖" /></td>
          <td class="col-num">㉖</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td>利子割引</td>
          <td class="col-num">㉒</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉗" /></td>
          <td class="col-num">㉗</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉘" /></td>
          <td class="col-num">㉘</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
        </tr>
        <tr>
          <td><input type="text" class="text-left" placeholder="科目㉙" /></td>
          <td class="col-num">㉙</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td><input type="text" class="text-left" placeholder="科目㉚" /></td>
          <td class="col-num">㉚</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
          <td>雑費</td>
          <td class="col-num">㉛</td>
          <td><input type="text" class="calc exp" onblur="fmt(this)" /></td>
        </tr>
        <tr style="background: var(--bg-pale)">
          <td>経費計</td>
          <td class="col-num">㉜</td>
          <td><input type="text" id="f32" class="readonly" /></td>
          <td colspan="2">差引(⑦-㉜)</td>
          <td class="col-num">㉝</td>
          <td><input type="text" id="f33" class="readonly" /></td>
          <td colspan="3"></td>
        </tr>
      </table>
      <div class="footer-num">- 1 -</div>
    </div>

    <div class="page-container" id="p2">
      <div class="form-title">月別売上・仕入金額</div>
      <table>
        <tr>
          <th>月</th>
          <th>売上金額</th>
          <th>仕入金額</th>
          <th>月</th>
          <th>売上金額</th>
          <th>仕入金額</th>
        </tr>
        <tbody id="month-rows"></tbody>
        <tr style="background: #eee">
          <td>計</td>
          <td><input type="text" id="ms_total" class="readonly" /></td>
          <td><input type="text" id="mc_total" class="readonly" /></td>
          <td colspan="3"></td>
        </tr>
      </table>
      <div class="footer-num">- 2 -</div>
    </div>

    <div class="page-container" id="p3">
      <div class="form-title">減価償却費の計算</div>
      <table>
        <tr>
          <th>資産名称</th>
          <th>取得価額</th>
          <th>耐用年数</th>
          <th>本年償却費</th>
          <th>未償却残高</th>
        </tr>
        <tbody id="dep-rows"></tbody>
        <tr style="background: #eee">
          <td>計</td>
          <td colspan="2"></td>
          <td><input type="text" id="d_total" class="readonly" /></td>
          <td></td>
        </tr>
      </table>
      <div class="footer-num">- 3 -</div>
    </div>

    <div class="page-container" id="p4">
      <div class="form-title">貸 借 対 照 表</div>
      <div style="display: flex; gap: 10px">
        <table style="width: 50%">
          <tr>
            <th colspan="2">資産の部</th>
            <th>期首</th>
            <th>期末</th>
          </tr>
          <tr>
            <td colspan="2">現金・預金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="ast-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">売掛金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="ast-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">棚卸資産</td>
            <td><input type="text" id="bs_inv_s" class="readonly" /></td>
            <td><input type="text" id="bs_inv_e" class="readonly" /></td>
          </tr>
          <tr style="background: #eee">
            <td>資産計</td>
            <td colspan="2"></td>
            <td><input type="text" id="ast_total" class="readonly" /></td>
          </tr>
        </table>
        <table style="width: 50%">
          <tr>
            <th colspan="2">負債・資本の部</th>
            <th>期首</th>
            <th>期末</th>
          </tr>
          <tr>
            <td colspan="2">買掛金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="liab-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">元入金</td>
            <td><input type="text" onblur="fmt(this)" /></td>
            <td><input type="text" class="liab-e" oninput="sumBS()" onblur="fmt(this)" /></td>
          </tr>
          <tr>
            <td colspan="2">所得(㊸番)</td>
            <td><input type="text" class="readonly" /></td>
            <td><input type="text" id="bs_income" class="readonly" /></td>
          </tr>
          <tr style="background: #eee">
            <td>負債計</td>
            <td colspan="2"></td>
            <td><input type="text" id="liab_total" class="readonly" /></td>
          </tr>
        </table>
      </div>
      <div class="footer-num">- 4 -</div>
    </div>

    <script>
      const nf = new Intl.NumberFormat("ja-JP");
      const val = (s) => parseFloat(String(s).replace(/,/g, "")) || 0;
      const set = (id, v) => {
        const el = document.getElementById(id);
        if (el) el.value = nf.format(v);
      };

      // 月別行生成
      const mRows = document.getElementById("month-rows");
      for (let i = 1; i <= 6; i++) {
        mRows.innerHTML += `<tr><td>${i}月</td><td><input type="text" class="m-s" oninput="sumM()"></td><td><input type="text" class="m-c" oninput="sumM()"></td><td>${i + 6}月</td><td><input type="text" class="m-s" oninput="sumM()"></td><td><input type="text" class="m-c" oninput="sumM()"></td></tr>`;
      }
      // 減価償却行生成
      const dRows = document.getElementById("dep-rows");
      for (let i = 0; i < 5; i++) {
        dRows.innerHTML += `<tr><td><input type="text" class="text-left"></td><td><input type="text" onblur="fmt(this)"></td><td><input type="text"></td><td><input type="text" class="d-val" oninput="sumD()" onblur="fmt(this)"></td><td><input type="text" onblur="fmt(this)"></td></tr>`;
      }

      function fmt(el) {
        el.value = el.value ? nf.format(val(el.value)) : "";
        calc();
      }

      function sumM() {
        let s = 0,
          c = 0;
        document.querySelectorAll(".m-s").forEach((e) => (s += val(e.value)));
        document.querySelectorAll(".m-c").forEach((e) => (c += val(e.value)));
        set("ms_total", s);
        set("mc_total", c);
        set("f1", s);
        set("f3", c);
        calc();
      }

      function sumD() {
        let t = 0;
        document.querySelectorAll(".d-val").forEach((e) => (t += val(e.value)));
        set("d_total", t);
        set("f18", t);
        calc();
      }

      function sumBS() {
        let a = 0,
          l = 0;
        document.querySelectorAll(".ast-e").forEach((e) => (a += val(e.value)));
        document.querySelectorAll(".liab-e").forEach((e) => (l += val(e.value)));
        a += val(document.getElementById("bs_inv_e").value);
        l += val(document.getElementById("bs_income").value);
        set("ast_total", a);
        set("liab_total", l);
      }

      function calc() {
        const f1 = val(document.getElementById("f1").value),
          f2 = val(document.getElementById("f2").value),
          f3 = val(document.getElementById("f3").value);
        const f4 = f2 + f3;
        set("f4", f4);
        const f5 = val(document.getElementById("f5").value);
        const f6 = f4 - f5;
        set("f6", f6);
        const f7 = f1 - f6;
        set("f7", f7);

        let exp = 0;
        document.querySelectorAll(".exp").forEach((e) => (exp += val(e.value)));
        exp += val(document.getElementById("f18").value); // 減価償却費
        set("f32", exp);
        const f33 = f7 - exp;
        set("f33", f33);

        let rev = 0;
        document.querySelectorAll(".res-rev").forEach((e) => (rev += val(e.value)));
        set("f37", rev);
        let resE = 0;
        document.querySelectorAll(".res-exp").forEach((e) => (resE += val(e.value)));
        set("f42", resE);

        const f43 = f33 + rev - resE;
        set("f43", f43);
        const ded = Math.min(Math.max(0, f43), val(document.getElementById("f44").value));
        set("f45", f43 - ded);

        // BS連動
        set("bs_inv_s", f2);
        set("bs_inv_e", f5);
        set("bs_income", f43);
        sumBS();
      }
    </script>
  </body>
</html>
