<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>簡易・青色申告シミュレーター</title>
    <style>
      body {
        font-family: sans-serif;
        background-color: #f4f7f6;
        padding: 20px;
        color: #333;
      }
      .container {
        max-width: 800px;
        margin: auto;
        background: #fff;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        color: #2c3e50;
        border-bottom: 2px solid #27ae60;
        padding-bottom: 10px;
      }

      .section {
        margin-bottom: 30px;
      }
      .input-group {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }
      input[type="number"] {
        width: 150px;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        text-align: right;
        font-size: 1rem;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 12px;
        text-align: left;
      }
      th {
        background-color: #f8f9fa;
      }
      .result-row {
        background-color: #e8f4fd;
        font-weight: bold;
      }
      .total-row {
        background-color: #27ae60;
        color: white;
        font-weight: bold;
      }
      .currency {
        text-align: right;
      }
      .currency::after {
        content: " 円";
      }

      .hint {
        font-size: 0.85rem;
        color: #666;
        margin-top: 5px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>青色申告決算シミュレーター</h1>

      <div class="section">
        <h3>1. 売上・原価の入力</h3>
        <div class="input-group">
          <label>売上金額（年間）</label>
          <input type="number" id="sales" value="0" oninput="calculate()" />
        </div>
        <div class="input-group">
          <label>売上原価（仕入など）</label>
          <input type="number" id="cost" value="0" oninput="calculate()" />
        </div>
      </div>

      <div class="section">
        <h3>2. 経費の入力</h3>
        <div class="input-group">
          <label>地代家賃（仕事分）</label>
          <input type="number" id="rent" class="expense" value="0" oninput="calculate()" />
        </div>
        <div class="input-group">
          <label>広告宣伝費</label>
          <input type="number" id="ads" class="expense" value="0" oninput="calculate()" />
        </div>
        <div class="input-group">
          <label>その他経費（合計）</label>
          <input type="number" id="other_exp" class="expense" value="0" oninput="calculate()" />
        </div>
      </div>

      <div class="section">
        <h3>3. 控除の設定</h3>
        <div class="input-group">
          <label>青色申告特別控除額</label>
          <select id="deduction_type" onchange="calculate()">
            <option value="650000">65万円 (電子申告等)</option>
            <option value="550000">55万円</option>
            <option value="100000">10万円</option>
          </select>
        </div>
      </div>

      <hr />

      <h3>計算結果（損益計算書 概算）</h3>
      <table>
        <tr>
          <th>項目</th>
          <th>金額</th>
        </tr>
        <tr>
          <td>(1) 売上金額</td>
          <td id="res_sales" class="currency">0</td>
        </tr>
        <tr>
          <td>(2) 売上原価</td>
          <td id="res_cost" class="currency">0</td>
        </tr>
        <tr class="result-row">
          <td>(3) 差引売上総利益 (1 - 2)</td>
          <td id="res_gross_profit" class="currency">0</td>
        </tr>
        <tr>
          <td>(4) 経費合計</td>
          <td id="res_total_exp" class="currency">0</td>
        </tr>
        <tr class="result-row">
          <td>(5) 差し引き所得金額 (3 - 4)</td>
          <td id="res_income" class="currency">0</td>
        </tr>
        <tr>
          <td>(6) 青色申告特別控除額</td>
          <td id="res_deduction" class="currency">0</td>
        </tr>
        <tr class="total-row">
          <td>課税対象となる所得金額 (5 - 6)</td>
          <td id="res_taxable" class="currency">0</td>
        </tr>
      </table>
      <p class="hint">※所得税額を計算する際は、ここからさらに「所得控除（基礎控除等）」を差し引く必要があります。</p>
    </div>

    <script>
      function calculate() {
        // 入力値の取得
        const sales = parseFloat(document.getElementById("sales").value) || 0;
        const cost = parseFloat(document.getElementById("cost").value) || 0;
        const deductionSetting = parseFloat(document.getElementById("deduction_type").value) || 0;

        // 経費の合計計算
        let totalExp = 0;
        const expenses = document.querySelectorAll(".expense");
        expenses.forEach((input) => {
          totalExp += parseFloat(input.value) || 0;
        });

        // 利益等の計算
        const grossProfit = sales - cost;
        const income = grossProfit - totalExp;

        // 青色申告特別控除の適用（所得以上の控除はできないため、所得金額を上限とする）
        const actualDeduction = Math.min(Math.max(0, income), deductionSetting);
        const taxableIncome = Math.max(0, income - actualDeduction);

        // 結果を画面に反映
        document.getElementById("res_sales").innerText = sales.toLocaleString();
        document.getElementById("res_cost").innerText = cost.toLocaleString();
        document.getElementById("res_gross_profit").innerText = grossProfit.toLocaleString();
        document.getElementById("res_total_exp").innerText = totalExp.toLocaleString();
        document.getElementById("res_income").innerText = income.toLocaleString();
        document.getElementById("res_deduction").innerText = actualDeduction.toLocaleString();
        document.getElementById("res_taxable").innerText = taxableIncome.toLocaleString();
      }

      // 初期実行
      calculate();
    </script>
  </body>
</html>
